---
apiVersion: v1
kind: Secret
metadata:
  name: registry-certificates
  namespace: registry
type: Opaque
data:
  domain.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUZwVENDQTQyZ0F3SUJBZ0lVQXRETm05Y3VhUlZzeG03SUtGdXVBYWhGSVdZd0RRWUpLb1pJaHZjTkFRRUwKQlFBd1lqRUxNQWtHQTFVRUJoTUNUa3d4RlRBVEJnTlZCQWdNREU1dmIzSmtTRzlzYkdGdVpERVNNQkFHQTFVRQpCd3dKU0dsc2RtVnljM1Z0TVJRd0VnWURWUVFLREF0U2FXTmhjbVJ2SUVsT1F6RVNNQkFHQTFVRUF3d0piRzlqCllXeG9iM04wTUI0WERUSXdNRGt5TWpBNE16UXhOVm9YRFRJeE1Ea3lNakE0TXpReE5Wb3dZakVMTUFrR0ExVUUKQmhNQ1Rrd3hGVEFUQmdOVkJBZ01ERTV2YjNKa1NHOXNiR0Z1WkRFU01CQUdBMVVFQnd3SlNHbHNkbVZ5YzNWdApNUlF3RWdZRFZRUUtEQXRTYVdOaGNtUnZJRWxPUXpFU01CQUdBMVVFQXd3SmJHOWpZV3hvYjNOME1JSUNJakFOCkJna3Foa2lHOXcwQkFRRUZBQU9DQWc4QU1JSUNDZ0tDQWdFQTRFVjJYem1XK1ErYmRUVU1KdTJZOVE2cXZ2RUwKK2ZSYjYyR0sxbzVCcjRac1dzanpkazkxNHRtT0ZBb3VGUDVVbmFxN1ZWRGYvZi92OHltSkVHZ1lKWC96V2JVWQpmQjVtdldHU3BZaS9MeWpIQWhLVC8zUllxQTRGTmhQa0FIdEwwU1JMOHhNcSs3akRYMW1qVHZDaG5FcFpDZmduCnpxYjE3WVJEYnl4KytQYzJ6OHlHdHZkT3B2OXpHSUdmWGE2d2VSWHkxQzV1TEYxNHB2Ulp6SDVTVVBzaFdwOXQKR0doQjJ6dW4xNGtvQXVQNTMwUFQ5eGZSTWNyWGpFNVBJTEVRc0NHKzVIRGRYV0RqY3ppRGhDZWFzTUJIa1NGVgp5eFFmUEgxS2NkZFhUMHI5azVqZk4zQzhKWjNTV1FmVjUvN1BwS2xkYkVPTDJUbjBheXpUMFE1YjEvTHNGUXEwCmRreE9qOTVEZWovUnJHYXF2VVd4RkhUeHc0Zm9IcXV4a0NadkRLU1k1U1hLa1hmZmQrQzQxbUNGVkZEc0xvQ2oKSkdBNHF3ZW9qUzd6LysxOVV4b1lDUHVJSkRxY0NXc0kzTlBHdTZWc1ZTbEEybjZsdXErRmw3bGJ4RTQ3N1hwNgo4b1o1c1dHZWtnVEIzRTdBTTkyQmduSGE2TDZ2aTFHcGRkOTZmb21MejBuTjBiZklKWHozenBkeGd5a1ozSG9ECmppaU5oNmlxSVRPeGVZY0gvNjJacThRMHdGZlRlSTZUazR3R1RzeDFUSzBYb0dxS2pETkt1dzQ5RDRub2VWRG0KckdMSzJ4VzBzVTZkeC9lRnN1Zkc1ZGZkR01remw5Qk8zaHE0aGx2ci9tVDZNVmFNWUZ4V09rT1pFRU5SVGsxcwpkSWxncmI5a1B0Mk5rU0VDQXdFQUFhTlRNRkV3SFFZRFZSME9CQllFRlB0Nk9mL3ZOVTFlVHZHRFRtakQ5enB5CkQ4SllNQjhHQTFVZEl3UVlNQmFBRlB0Nk9mL3ZOVTFlVHZHRFRtakQ5enB5RDhKWU1BOEdBMVVkRXdFQi93UUYKTUFNQkFmOHdEUVlKS29aSWh2Y05BUUVMQlFBRGdnSUJBSnpFZG0yVldGRmk4Vi9GNWpFeWJZS2RlSWkraG4zTgpwVC9QaDVRR2Y5S3JYTDZuNTR5alUzallEVEw3R2VRWVJIdlE3ZDlWcjh2OHFwREZneGMwcUNPaUt5SGVkUHBUClpWY0pUMHJOZ2d0SHZRcUNuOUZHbnBpYUNWamhOU3hYYkZJNERyZHI1d0dmaWVGdWtPV2VHaXZ2ZXI2cy9RK2EKVk1DclRqNDdncTFuNU1IYWxJVStKRSs1MmYycHJxK0o3Uk5HZVdmQlA5RFlacVhPdGVMS2lYaExMU0QrYXk5TApKYUlsL0I2enFNYU1NM0ZaMDRoVXp2Z0RpTjdVdEFob1Rrb05jN3FGdXFnb2ZmdFJFdHFTZytUSXliTEUrK2xSCkhWV3EwNXMvK3JidzA4VTNpdnFxdUtvNTQzTENxOGxDbDdZRm9SVnc0eWJtVFpwNHBKbmIwRGhPeklWSk9Ec1YKYTFhVzRkakRhekVuQlpFSTltUUlKRXhyazRNT2U3ajhDM1RRcDBleDB3T3VTaG4rYXJjd0gzR1Vic2pkRnp5VwpTY01yeFVrNDB5cmlKQ3ZvUG5xbHJtSy9xaUlqTlVYQThMT3J4ODNOeWFicmR4SkhEUHFURnNsby9xRkdnWEpWCjhISzFjTnl2UkpJRFJnaW5rZXBIWXBuRGdqQVdqVHlLblBBL2ZvMFVHRTJWSDJ0TXFMVklCSlhrNzExNXE2OTIKMHdCOWlZbmgxb0QxSWlMYjNnRTIxdWtGbFJQMlQ4L3ByOEs2MTZPY3FmZ0wrQUN5L3Z4UTRqa0tqUFhUemc0RQpoTnM5SEsvOC8zQzhhMVZYenlhdlpOUFBVZWprVS9yTVZoLzlXbUJ6WVlaZ0wxUFBLb3VSeEp3RGF0S0RaNTRYCldueVgwVmpsbWdLTwotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
  domain.key: LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUpSUUlCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQ1M4d2dna3JBZ0VBQW9JQ0FRRGdSWFpmT1piNUQ1dDEKTlF3bTdaajFEcXErOFF2NTlGdnJZWXJXamtHdmhteGF5UE4yVDNYaTJZNFVDaTRVL2xTZHFydFZVTi85LysvegpLWWtRYUJnbGYvTlp0Umg4SG1hOVlaS2xpTDh2S01jQ0VwUC9kRmlvRGdVMkUrUUFlMHZSSkV2ekV5cjd1TU5mCldhTk84S0djU2xrSitDZk9wdlh0aEVOdkxINzQ5emJQeklhMjkwNm0vM01ZZ1o5ZHJyQjVGZkxVTG00c1hYaW0KOUZuTWZsSlEreUZhbjIwWWFFSGJPNmZYaVNnQzQvbmZROVAzRjlFeHl0ZU1Uazhnc1JDd0liN2tjTjFkWU9OegpPSU9FSjVxd3dFZVJJVlhMRkI4OGZVcHgxMWRQU3YyVG1OODNjTHdsbmRKWkI5WG4vcytrcVYxc1E0dlpPZlJyCkxOUFJEbHZYOHV3VkNyUjJURTZQM2tONlA5R3NacXE5UmJFVWRQSERoK2dlcTdHUUptOE1wSmpsSmNxUmQ5OTMKNExqV1lJVlVVT3d1Z0tNa1lEaXJCNmlOTHZQLzdYMVRHaGdJKzRna09wd0phd2pjMDhhN3BXeFZLVURhZnFXNgpyNFdYdVZ2RVRqdnRlbnJ5aG5teFlaNlNCTUhjVHNBejNZR0NjZHJvdnErTFVhbDEzM3AraVl2UFNjM1J0OGdsCmZQZk9sM0dES1JuY2VnT09LSTJIcUtvaE03RjVod2YvclptcnhEVEFWOU40anBPVGpBWk96SFZNclJlZ2FvcU0KTTBxN0RqMFBpZWg1VU9hc1lzcmJGYlN4VHAzSDk0V3k1OGJsMTkwWXlUT1gwRTdlR3JpR1crditaUG94Vm94ZwpYRlk2UTVrUVExRk9UV3gwaVdDdHYyUSszWTJSSVFJREFRQUJBb0lDQVFDdDZZKzZsa2taeUYyUURWdm9FQld0CjZ2ckRhTjhWck1WZkNWd0Z0M2orYVNvN1dGdGJvcERUSWt2SUJJRHByTFBuTkE5alFIMENWZWMzMUR6Q3FVWVkKUmxscWRrR1BkbS9MYWcrektCREJ2RWhldGhOb1pFdWZ2b2VTQU9pczZ1L0hOZk5qZ3JpeFRQek1ReEdkMUlJdQpWWVVvY3ZSRGp6dGtQVTJodDRxYSsvSFlRRTB6TXlJZDVEZlhpQ1VTRzdZam43NlhoWTNQLzRmaFI5a2U5OUpUCmsvcXdjTExEMjQwK09jdVZHM29ZaTdzbnhFeHA3MkU4MElSSC9DM21Od2l1M094UDc2bnBrSW13dnVGVnFQU1AKSGZ3aGNnMDZsdGNHTEU1L2F6TDhmVFdZc0ZKZ2hwNlFPUXQyR05wcXRqRkZDa1UxQUVoQlltekVjNVdxSncxVwpPNEFmOVI0dHVKWkJwQWlVVXFQM0tQVUwxOHY2VFd1M25vNXBiT1pHaGx0RDZLcjJ1d0cvUHRjbjMxMnJaOHU0CjVrNGRZUUNhc1E5U055VjJtNnhsNkRKdE03WmVJWW5iMEI0S0lMZjUzRnlnZ00vZWxVL0s4LzNiWTNleTVXdGcKdFhLcWUvRUhSSHJUaCtNalA2bmdydFJkU29WRlhpUjQvaVRVMFpkUHVIVXhCYkg1MjdabnVQR2lOdGpWWUE4MApRKzhuYTBiUFZlaTdYd2FBb1Z2WFR6Nmpud2R0ZnZjQk5DMFBySXBMMDdsL3VaaGNmYW1KWEYxaitWaU9hdHhkClp4NzFtS2F1RmlJWEd5eHBPcVJoRmsrSlk4dlMyUWZiblB0NjVzTi9LSmtDTVFuMFM3SUtjaERFTGRscnN1N00KNURzeW1JaE5Dc0xXd2w2eHpLWDBWUUtDQVFFQS9kalZtVzZLcmpFRjVGV3UzNGVSdzV3cXFwaTFHRVpheDhqeQphN0lxRS9wQUtwUmd5angzeEdsejY2eEIrbXoxRzFCelNsYkJMUm1SbkphMENmeWs1aGF2UllsVk5xdnBzYitXCm0zMHRlbXh1VTNmZHNRKzk1cEdxN1owUGs3OWViU0Fud0krRGNZVjhVeHljRG9YYXpWUWE4KzNJZHdtMWZOUEwKZ3h6RUhoK1AveWs0VTNjZEd1MUFLS0Q4V3EzWHduL0IwNkZzWjhXL0l5dVRVUnJ0RUdaK0M5UXd2b0NtTUsvUwpFdzNweGQ5N0trdHVScFBVSEhOaVVNbHA4Vk5LNGxxcWsyYlVaOTJaM1NzSEpyV21QUUNIRVowVWROZXpldlVhCk9BZU1sWHhlNERXeUpqOWxVbG9Qdzl2eGc5bTlzQ0VHK2U1OFRRVUIwMDRQd1F3c3p3S0NBUUVBNGl4cGJBaWUKRGY1Z2paNzlRNnFJcXJQV1J3M1M3T21HRmhVNnRlRzdZL2MxTHBtYWh1SW9CaXZXZWx1MDRIeE1VY2JhSVdEdApFbXRhTkpwbndSMzVPaHJHd2haK1FOa2Vib1JRbW8ySDNYVk1LMTliSG1VdmsxMUtycGhORllrYXdReWUzRXFoCjc0MDFzL0JiZUNBUlBRMEljMzE0NlRrRjZKTEhmeVFnOXZQUG9lRUliSGVBU0pySkUvSi9YQUg1WDAwQy9OVUUKNjhpTUs4TEFNci9GUGtkczNCenZiK01VUFBySFRXMFJ2UTdHdzBESWJzYWVHVGNmblhZZXdoT3NDMzgzU29XYgpqeEZHZEFrY2JuaVhxdzEySzQ4MTBpdVpyZHM4aVh0b3ovanRlb2hiS0R5S3FYNTdnQWlpbWpUOEFrNUFXSWVtCkFISDRFZUVQV0RBL0R3S0NBUUVBelpUU1NGUnlFK2kzOE5oRHE5eExmTFA1Q2ZocWthSkkyd3d1NkhGK0NuZmQKaDU1clZOM3IwVEhtSTdONks2b2FSMmk4TmpSVWRvWUNtMktocElUcnR6d2Y3cHp1V2p5WUl0QWExUXBuem9JSwpSNmNINytIajFkdWJKcHpRaE1PellZVnRMRklPRGQ0aGRkM3h0UUZLMW9lSzNJcHlrNVZWV2liYzV1NWhGbFJSCmRrQ1gwV0RpUFhCdlNYZzNaK2pxbUNhSGZ6RjRiZ0tFYmFOWXg1S2E4M0ZPRzU1WmE2OGM2TWs3eFJxN2ZQa2sKOG5mc2MxUTlzRnp4L3FOZ0hZVnJYQzQ1ZnU4RWpxbTFkcHptU2I5TFJwUXF6MlQ3c0RVUXNqL1dZQklkRk9PSQpvdVJaeHdnSXNzMGxmMldkRHo5RWxHUHJGbmJDVEU0RjBHK2o2cUJGbVFLQ0FRRUFuanRuL2RjQmpOUzhoQmdKCkkvLzQ0VVF6MHo0T3BRU3pkRnVoMllGMWNuaU8wbTFRT0xHY1FzVUVwbEhtZDI4K2phL0xCN01oNk5NR0p1c24KVDJwQzVLMjdCQ3BzWmI0QWxsMG5ieGs1Um13N3Y5UlVrUzFGWFpuVkY5VWhpTUdFNEM2T0xaeGhNcERlVTJjQwo5MFdvQ2NoR2MxWUM4MWVibEp5cnlYMWpPcUpVVHZKNnpEZkduZ1Q4VEdKSlMvdHRsWWp4WUNVLzdoMCtRNWRhCms2YXF2ZW1HZFhBZzYydzR5bmpBV3FERjJqaXVRZ2Zlc2ZGdXhrRlVjdnNpaGJEeG1wR0VBelQ2SWR0NktNLysKL2lLTUtYV2ZpTllHVjJWOWZLNTI2ZEJYQWJrcm02QXQ5alowNUNQREQwMzdSRnR4TzhPM0xMaXFJSUdiaGhhbwpmNUF4YlFLQ0FRRUEzS0lJVktpSmVTcWtWL3o4VjRsOHhKME53WThYd3R5RlE2WnZ0SElRZTVhS0sydlF2dG5iCjZRTjB1REZsaGo3bks1Z3hES0tYdFk5NmliWTE0QWRaaEwvWEV4SjRKcmU3RFVBMDZPdW9GbVc3K3YvY2tpZTIKd1V0WGEyNHI5WXp2SWpHcHBvRmlQb2Z2bFc1VlRpN3U2Z3ZwNEMxVEFRdzYyanlZQ2d0QXExdm9lY2xmRDY0SgpxU0Y0Rzc4azlSQURtTU5LTFU1Z1l1WUxydnVMU2RrdzZrdTY5dEk2Ry9uSDV0RHNuU0EwMmVDMjlTT2NhNjV4CjN5ZUhKdHRlWGNIcjdHeG5BenNLQlc3dFI0bVQrdkR2TVhFWHJ6eFRxd01kQ1g4T3h4SU5wa24vdFVBYnZTd3EKMW5OSGMwelFydWFicjFLNFUrZGtIMTVtUnN4dHl6L096dz09Ci0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS0K
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: registry
  namespace: registry
  labels:
    app: registry
spec:
  replicas: 1
  selector:
    matchLabels:
      app: registry
  template:
    metadata:
      labels:
        app: registry
    spec:
      containers:
      - name: registry
        image: docker.io/library/registry:2
        env:
        - name: REGISTRY_HTTP_TLS_CERTIFICATE
          value: /certs/domain.crt
        - name: REGISTRY_HTTP_TLS_KEY
          value: /certs/domain.key
        volumeMounts:
          - name: registry-certificates
            mountPath: /certs
        ports:
        - containerPort: 5000
      volumes:
      - name: registry-certificates
        secret:
          secretName: registry-certificates
---
kind: Service
apiVersion: v1
metadata:
  name: local
  namespace: registry
spec:
  type: LoadBalancer
  ports:
  - name: https
    port: 5000
    targetPort: 5000
  selector:
    app: registry
